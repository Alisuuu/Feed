<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="style.css" />
  <title>Notícias de Cinema</title>
</head>
<body>
  <main id="news-container">
    <p>Carregando notícias...</p>
  </main>

  <script>
    async function fetchNews() {
      const newsContainer = document.getElementById('news-container');
      newsContainer.innerHTML = '<p>Carregando notícias...</p>';

      try {
        const response = await fetch('/api/news');
        const data = await response.json();

        if (data.noticias && data.noticias.length > 0) {
          newsContainer.innerHTML = '';

          data.noticias.forEach(article => {
            const articleElement = document.createElement('article');
            articleElement.classList.add('news-item');

            if (article.image) {
              const img = document.createElement('img');
              img.src = article.image;
              img.alt = article.title || 'Imagem da notícia';
              img.loading = 'lazy';
              articleElement.appendChild(img);
            }

            const contentDiv = document.createElement('div');
            contentDiv.classList.add('news-content');

            const title = document.createElement('h2');
            const link = document.createElement('a');
            link.href = article.link;
            link.target = "_blank";
            link.textContent = article.title;
            title.appendChild(link);
            contentDiv.appendChild(title);

            if (article.sinopse) {
              const description = document.createElement('p');
              description.textContent = article.sinopse;
              contentDiv.appendChild(description);
            }

            articleElement.appendChild(contentDiv);
            newsContainer.appendChild(articleElement);
          });
        } else {
          newsContainer.innerHTML = '<p>Nenhuma notícia encontrada no momento.</p>';
        }

      } catch (error) {
        console.error('Erro ao buscar notícias:', error);
        newsContainer.innerHTML = '<p>Ocorreu um erro ao carregar as notícias. Tente novamente mais tarde.</p>';
      }
    }

    window.onload = fetchNews;
  </script>
</body>
</html>
